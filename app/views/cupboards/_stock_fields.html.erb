<li class="control-group nested-fields">
  <div class="controls">
    <%= f.label :amount, "Amount:" %>
    <%= f.text_field :amount %>

    <%= f.fields_for :ingredient do |stock_ingredient| %>
      <%# TODO: preselect unit for ingredient %>
      <%# = collection_select(:portion_ingredient, :unit_id, Unit.all, :id, :name, {:selected => 2}) %>
      <%= stock_ingredient.text_field :name %>
    <% end %>

    <%= link_to_remove_association "remove", f %>
  </div>
</li>
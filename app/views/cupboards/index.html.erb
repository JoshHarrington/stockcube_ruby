<% provide(:title, 'Your cupboards') %>
<div class="main">
  <div class="container">
    <h2>All Cupboards</h2>
    <% if params[:show_all] == 'true' %>
      <%= link_to "Only show in date", cupboards_path %>
    <% else %>
      <%= link_to "Show all", cupboards_path(:show_all => 'true') %>
    <% end %>
    <div class="list_block--collection">
      <% @cupboards.each do |cupboard| %>
      <div class="cupboard list_block<%= cupboard_empty_class(cupboard) %>">
        <h3 class="list_block--title"><%= cupboard.location %></h3>
        <% if cupboard.stocks.first %>
          <% cupboard.stocks.order(use_by_date: :desc).each do |stock| %>
            <% if params[:show_all] == 'true' || (stock.use_by_date - Date.current).to_i >= -2 %>
              <div class="list_block--item<%= date_warning_class(stock) %>">
                <p><%= stock.ingredient.name %></p>
                <p><%= stock.amount %> <%= stock.ingredient.unit.name %></p>
              </div>
            <% end %>
          <% end %>
        <% end %>
        <%= link_to "Add more stock",  stocks_new_path(:cupboard_id => cupboard.id), {:class => "list_block--item list_block--item-new"} %>
      </div>
    <% end %>
    <%= link_to cupboards_new_path, {:class => "list_block"} do %>
      <p>Add a new cupboard / storage location</p>
    <% end %>
    </div>
  </div>
</div>
